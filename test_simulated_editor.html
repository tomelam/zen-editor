<!DOCTYPE html>
<html lang='en'>
<head>
	<meta http-equiv="Content-type" content="text/html; charset=utf-8">
	<title>Simulated Editor</title>

    <style type="text/css">
        @import "dojo/dijit/themes/claro/document.css";
        @import "dojo/dijit/tests/css/dijitTests.css";
        @import "dojo/dijit/themes/claro/claro.css";
        @import "dojo/dojox/mobile/themes/common/dijit/dijit.css";
    </style>

	<style type="text/css">
		form { margin-bottom : 0; }
		table { border: none; }
		#dialog3_underlay { background-color: #027 }
		#fifthDlg_underlay { background-color: yellow; }
	</style>

        <script type="text/javascript" src="dojo/dojo/dojo.js"></script>

	<script type="text/javascript">
		require([
			"dojo/_base/lang",
			"dojo/date/stamp",
                        "dojo/dom",

			"dijit/registry",
			"dijit/Dialog",
			"dijit/form/Button",

			// used by parser
			"dijit/Editor",
			"dijit/_editor/plugins/AlwaysShowToolbar",
			"dijit/InlineEditBox",
			"dijit/Menu",
			"dijit/MenuItem",
			"dijit/MenuSeparator",
			"dijit/form/TextBox",
			"dijit/form/DateTextBox",
			"dijit/form/TimeTextBox",
			"dijit/form/FilteringSelect",
			"dijit/layout/BorderContainer",
			"dijit/layout/ContentPane",
			"dijit/layout/TabContainer",

			"dojo/domReady!"
		], function(lang, stamp, dom, registry, Dialog, Button){

			var thirdDlg, editor;
			createDialog = function(){
                                editor = dom.byId("editor");
                                dom.byId("dialogTextarea").value = editor.value;
                                if(!thirdDlg){
                                        console.log("creating dialog");
					var pane = dom.byId('thirdDialog');
					// should specify a width on dialogs with <p> tags, otherwise they get too wide
					thirdDlg = new dijit.Dialog({
						id: "dialog3",
						title: "Programmatic Dialog Creation",
						style: {width: '300px'}
					},pane);
				}
                                thirdDlg.show();
                                var myButton = new Button({
                                        label: "Accept",
                                        onClick: function(){
                                                editor = dom.byId("editor");
                                                newVal = dom.byId("dialogTextarea").value;
			                        console.log("focusing editor and setting value to " + newVal);
			                        editor.focus();
                                                editor.value = newVal;
                                        }
                                }, "editButton").startup();

                                var closeButton = new Button({
                                        label: "Close",
                                        onClick: function(){
                                                thirdDlg.hide();
                                        }
                                }, "editCloseButton").startup();
                        };

		});
        </script>
</head>
<body class="claro" role="main">

	<h2>Simulated Editor with Dialog</h2>

        <button onclick="createDialog();">Edit</button>
        <br />

	<div id="thirdDialog" style="display: none;">
		<p>
			Enter text then hit OK.
			Focus will be shifted to "editor" below and text will be ed.
		</p>
		<textarea id="dialogTextarea" style="width: 90%" placeholder="enter text here"></textarea>
		<br>
        	<div id="editButton"></div>
	        <div id="editCloseButton"></div>
	</div>
	<textarea id="editor" style="width: 90%; border: solid gray 1px;">initial value</textarea>

</body>
</html>